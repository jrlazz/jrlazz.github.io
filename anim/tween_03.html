<!DOCTYPE html>
<html lang="en">
<head>
<title>tween_03.html</title>
<meta charset="utf-8">
<link rel="shortcut icon" href="ok.ico"/>

<style>
body{margin:0px;background-color:#ccc;font-family:Monospace;overflow:hidden;}
</style>

<script async src="https://unpkg.com/es-module-shims@1.6.3/dist/es-module-shims.js"></script>

<script type="importmap">
	{
		"imports":{
			"three":"https://unpkg.com/three@0.158.0/build/three.module.js",
			"three/addons/":"https://unpkg.com/three@0.158.0/examples/jsm/"
		}
	}
</script>

</head>

<body>

<span style="position:absolute;left:10px;top:10px;color:#009;font-size:20.5pt;">Move Head ... Keys Y and N</span>
<img src="img/rgbmapS.png" style="position:absolute;left:-200px;"></img>
<button style="position:absolute;left:84%;top:84%;background-color:#ccc;text-align:center;"><a id="code" href="tween_03.txt" target="_blank" style="color:#009;text-decoration:none;font-size:20.5pt;">The Code</a></button>

<script type="module">

import * as THREE from "three";
import { OrbitControls } from "three/addons/controls/OrbitControls.js";
import { GLTFLoader } from "three/addons/loaders/GLTFLoader.js";

var scene,camera,renderer,controls;
var hombre,cuerpo,cabeza,cabeza2,loader,glb,axes;
var giro1=0;
var giro2=0;
var conta=0;
var interval1,interval2;

function init(){

	scene=new THREE.Scene();
	scene.position.y=-2;
	camera=new THREE.PerspectiveCamera(40,innerWidth/innerHeight,1,1000);
	camera.position.set(0,5,10).setLength(10);

	renderer=new THREE.WebGLRenderer({antialias:true,alpha:true});
	renderer.setSize(window.innerWidth,window.innerHeight);
	renderer.setClearColor('#069',0);
	renderer.outputColorSpace=THREE.LinearSRGBColorSpace;
	document.body.appendChild(renderer.domElement);

	window.addEventListener("resize",event => {
		camera.aspect=innerWidth/innerHeight;
		camera.updateProjectionMatrix();
		renderer.setSize(innerWidth,innerHeight);
	})

	controls=new OrbitControls(camera,renderer.domElement);

	scene.add(new THREE.AmbientLight('#fff',0.5));

	loader=new GLTFLoader();
	loader.load('models/extras/hombre_formas02.glb',function(gltf){
	glb=gltf.scene;

	glb.traverse(function (child) {
        if (child.isMesh) {
		child.castShadow=true;
		child.frustumCulled = false;
		child.geometry.computeVertexNormals();
        }
	});

	hombre=glb.clone();

	cabeza=glb.children[0].children[0];
	cabeza.position.set(0,0,0);
	cabeza.rotation.set(0,0,0);

	cabeza2=cabeza.clone();
	cabeza2.position.set(0,-3,0);
	axes=new THREE.AxesHelper(0.1);
	axes.add(cabeza2);
	axes.position.set(0,3,0);

	cuerpo=glb.children[0].children[1];
	cuerpo.position.set(0,0,0);
	cuerpo.rotation.set(0,0,0);

	//hombre.add(cabeza);
	//hombre.add(cuerpo);
	//scene.add(hombre);
	//scene.add(cabeza);
	scene.add(axes);
	scene.add(cuerpo);

	});


}

window.addEventListener("keydown",event => {
	if(giro1==0 && giro2==0){
		if(event.keyCode==89){giro1=1;sim();conta=0;};
  		if(event.keyCode==78){giro2=1;nao();conta=0;};
	}
})

function sim(){interval1=setInterval(funsim,20);}
function funsim(){
	conta++;
	if(conta<20){axes.rotation.x +=0.05;}
	if(conta>20 && conta<40){axes.rotation.x -=0.05;}
	if(conta>=40){clearInterval(interval1);axes.rotation.x=0;conta=0;giro1=0;}
}

function nao(){interval2=setInterval(funnao,20);}
function funnao(){
	conta++;
	if(conta<20){axes.rotation.y +=0.05;}
	if(conta>20 && conta<60){axes.rotation.y -=0.05;}
	if(conta>60 && conta<80){axes.rotation.y +=0.05;}
	if(conta>=80){clearInterval(interval2);axes.rotation.y=0;conta=0;giro2=0;}
}

function animate(){
	requestAnimationFrame(animate);
	controls.update();
	renderer.render(scene,camera);
}

init();
animate();

</script>

</body>

</html>
