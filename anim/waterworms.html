<!DOCTYPE html>
<html lang="en">
<head>
<title>waterworms.html</title>
<meta charset="utf-8">
<link rel="shortcut icon" href="https://threejs.org/files/favicon.ico"/>

<style>
span{position:absolute;font-family:Monospace;font-size:9pt;color:#006;z-index:2;cursor:pointer;}
body{margin:0px;background-image:url('img/sea.jpg');overflow:hidden;background-size:100% 100%;background-color:#2086d8;}
.abs{position:absolute;}
button{border-radius:50%;font-family:Arial;font-size:16pt;font-weight:bolder;padding:0px;cursor:pointer;}
a{cursor:pointer;}
</style>

</head>

<body>

<table id="tabaud" style="position:absolute;"><tr>
<td colspan="3" style="text-align:center;"><img id="samick" src="img/samick_r2.png" width="40"></img></td></tr><tr>
<td style="width:50px;text-align:right;"><button onclick="dim();" style="width:30px;height:30px;">-</button></td>
<td style="width:50px;text-align:center;"><img id="alto" src="img/aud_ff0.png" width="20"></img></td>
<td style="width:50px;text-align:left;"><button onclick="aum();" style="width:30px;height:30px;">+</button></td></tr>
</table>

<span id="spanA" style="left:10px;top:5px;">right click &rarr; inspect &rarr; source code</span>
<img id="tv" class="abs" src="img/tvgr.png" style="left:0px;top:40px;width:270px;z-index:1;"></img>

<img id="indio" class="abs" src="img/indio.png" style="left:29px;top:101px;width:165px;height:132px;z-index:2;"></img>

<img id="tvg" onclick="ifralimp();"  class="abs" src="img/tvgreen.png" style="left:198px;top:108px;width:40px;z-index:2;"></img>
<img id="tvr" onclick="ifralimp();"  class="abs" src="img/tvred.png" style="left:198px;top:108px;width:40px;z-index:2;display:none;"></img>

<iframe id="ifra" src="waterworms_clean.html" scrolling="no" style="position:absolute;left:29px;top:102px;width:165px;height:130px;background-color:#156;z-index:1;border:0px;"></iframe>

<audio id="au" loop style="left:100px;top:50px;"><source src="satisfaction.mp3" type="audio/mpeg"></audio>

<svg id="clo" viewBox="0 0 50 50" style="position:absolute;left:40%;top:30%;width:50%;z-index:2;display:;">
<circle id="c1" style="stroke:#0ff;stroke-width:0.1px;fill:#0240;display:none;" cx="10" cy="10" r="4"></circle>
<circle id="c2" style="stroke:#0ff;stroke-width:0.1px;fill:#0240;display:none;" cx="10" cy="10" r="3.5"></circle>
<circle id="c3" style="stroke:#0ff;stroke-width:0.1px;fill:#0240;display:none;" cx="10" cy="10" r="3"></circle>
<circle id="c4" style="stroke:#0ff;stroke-width:0.1px;fill:#0240;display:none;" cx="10" cy="10" r="2.5"></circle>
</svg>

<img id="fish1" class="abs" src="img/fish1.png" style="left:-200px;top:400px;width:70px;z-index:-1;"></img>
<img id="fish2" class="abs" src="img/fish2.png" style="left:-200px;top:350px;width:70px;z-index:-1;"></img>
<img id="fish3" class="abs" src="img/fish3.png" style="left:-200px;top:200px;width:50px;z-index:-1;"></img>
<img id="fish4" class="abs" src="img/fish4.png" style="left:-200px;top:400px;width:90px;z-index:-1;"></img>

<script type="module">

import * as THREE from '../js/three.module_res_res.js';
import { OrbitControls } from '../js/OrbitControls_res_res.js';

var renderer, scene, camera, controls, pointLight, ambientLight, frontLight;

var w=0;
var w1=0;
var w2=0;
var w3=0;
var w4=0;

var ponta=[];
var group=new THREE.Group();
for(let i=0;i<51;i++){group[i]=new THREE.Group();}

var torusG, torusMP, torusMR;
var torus=[];

var pontaG, pontaMB, pontaMP, pontaMR, pontaMY;

var element;

function init(){

	//BI=document.getElementById('inp');BI.onchange=function StartAnimation(){ex1();}

	renderer = new THREE.WebGLRenderer({antialias:true,alpha:true});
	renderer.setPixelRatio( window.devicePixelRatio );
	renderer.setClearColor(0x000000,0);
	renderer.setSize(window.innerWidth,window.innerHeight);
	document.body.appendChild(renderer.domElement);

	scene=new THREE.Scene();

	camera = new THREE.PerspectiveCamera(60, window.innerWidth/window.innerHeight,1,1000);
	camera.position.set(0,0,40);

	controls=new OrbitControls(camera,renderer.domElement);
	controls.minDistance=20;
	controls.maxDistance=60;
	controls.enablePan=true;
	controls.enableZoom=true;
	controls.enableRotate=true;
	controls.enableDamping=true;

	ambientLight=new THREE.AmbientLight("#fff",1);
	scene.add(ambientLight);

	frontLight=new THREE.DirectionalLight('#ff0',1);
	frontLight.position.set(0,0,-80);
	scene.add(frontLight);

	pointLight=new THREE.PointLight('#ff0',1);
	pointLight.position.set(0,0,80 );
	scene.add(pointLight);

	pontaG=new THREE.SphereGeometry(1,16,32);
	pontaMB=new THREE.MeshStandardMaterial({color:0x000000});
	pontaMY=new THREE.MeshStandardMaterial({color:0xffff00,metalness:0.7,roughness:0.2});
	pontaMR=new THREE.MeshStandardMaterial({color:0xff6666,metalness:0.7,roughness:0.2});
	pontaMP=new THREE.MeshStandardMaterial({color:0xff00ff,metalness:0.7,roughness:0.2});

	ponta[30]=new THREE.Mesh(pontaG,pontaMB)
	ponta[30].scale.set(0.2,0.2,0.2);
	ponta[30].position.set(-0.8,-0.4,-0.5);
	ponta[40]=ponta[30].clone();
	ponta[40].position.set(-0.8,-0.4,0.5);
	ponta[50]=ponta[30].clone();
	ponta[50].scale.set(0.2,0.2,0.5);
	ponta[50].position.set(-0.2,-0.9,0);

	ponta[31]=ponta[30].clone();
	ponta[41]=ponta[40].clone();
	ponta[51]=ponta[50].clone();

	ponta[1]=new THREE.Mesh(pontaG,pontaMY)
	ponta[1].position.set(-6,0,0);
	ponta[1].add(ponta[30]);
	ponta[1].add(ponta[40]);
	ponta[1].add(ponta[50]);

	ponta[2]=new THREE.Mesh(pontaG,pontaMR)
	ponta[2].position.set(6,0,0);

	ponta[10]=new THREE.Mesh(pontaG,pontaMY)
	ponta[10].position.set(-6,0,0);
	ponta[10].add(ponta[31]);
	ponta[10].add(ponta[41]);
	ponta[10].add(ponta[51]);

	ponta[20]=new THREE.Mesh(pontaG,pontaMP)
	ponta[20].position.set(6,0,0);

	torusG=new THREE.TorusGeometry(3,1,32,32,Math.PI);
	torusMR=new THREE.MeshStandardMaterial({color:0xff6666,metalness:0.7,roughness:0.2});
	torusMP=new THREE.MeshStandardMaterial({color:0xff00ff,metalness:0.7,roughness:0.2});

	torus[1]=new THREE.Mesh(torusG,torusMR);
	torus[1].scale.set(1,0.7,1);
	torus[1].position.set(-3,0,0);
	torus[1].rotation.set(0,0,0);
		torus[2]=torus[1].clone();
		torus[2].position.set(3,0,0);
		torus[2].rotation.set(0,0,Math.PI);
	torus[3]=torus[1].clone();
	torus[3].position.set(3,0,0);
		torus[4]=torus[2].clone();
		torus[4].position.set(3,0,0);
	torus[5]=torus[1].clone();
	torus[5].position.set(3,0,0);


	torus[10]=new THREE.Mesh(torusG,torusMP);
	torus[10].scale.set(1,0.7,1);
	torus[10].position.set(-3,0,0);
	torus[10].rotation.set(0,0,0);
		torus[20]=torus[10].clone();
		torus[20].position.set(3,0,0);
		torus[20].rotation.set(0,0,Math.PI);
	torus[30]=torus[10].clone();
	torus[30].position.set(3,0,0);
		torus[40]=torus[20].clone();
		torus[40].position.set(3,0,0);
	torus[50]=torus[10].clone();
	torus[50].position.set(3,0,0);

	window.addEventListener('resize',onWindowResize);
	onWindowResize();

}

function ex1(){}

function onWindowResize(){
	camera.aspect=window.innerWidth/window.innerHeight;
	camera.updateProjectionMatrix();
	renderer.setSize(window.innerWidth,window.innerHeight);
	document.getElementById("tabaud").style.left=window.innerWidth-160+"px";
	document.getElementById("tabaud").style.top=window.innerHeight-160+"px";
}

function animate(){
	requestAnimationFrame(animate);
	renderer.render(scene,camera);
	controls.update();
	w++;
	scene.rotation.y +=0.01;
	if(w>35){
		group[5].rotation.y +=0.03;
		group[4].rotation.y -=0.03;
		group[3].rotation.y +=0.06;
		group[2].rotation.y -=0.03;
		group[1].rotation.x +=0.01;
		group[1].rotation.z +=0.02;

		group[50].rotation.y +=0.06;
		group[40].rotation.y -=0.05;
		group[30].rotation.y +=0.02;
		group[20].rotation.y -=0.01;
		group[10].rotation.z +=0.03;
		document.getElementById("indio").style.display="none";
	}

	if(w==30){
		group[1].add(ponta[1]);
		group[5].add(ponta[2]);
			group[5].add(torus[5]);group[5].position.set(6,0,0);
			group[4].add(torus[4]);group[4].position.set(6,0,0);group[4].add(group[5]);
			group[3].add(torus[3]);group[3].position.set(6,0,0);group[3].add(group[4]);
			group[2].add(torus[2]);group[2].add(group[3]);
			group[1].add(torus[1]);group[1].add(group[2]);
			scene.add(group[1]);
			group[1].position.set(0,0,-20);
		group[10].add(ponta[10]);
		group[50].add(ponta[20]);
			group[50].add(torus[50]);group[50].position.set(6,0,0);
			group[40].add(torus[40]);group[40].position.set(6,0,0);group[40].add(group[50]);
			group[30].add(torus[30]);group[30].position.set(6,0,0);group[30].add(group[40]);
			group[20].add(torus[20]);group[20].add(group[30]);
			group[10].add(torus[10]);group[10].add(group[20]);
			scene.add(group[10]);
			group[10].scale.set(0.5,0.5,0.5);
			group[10].position.set(-10,5,-2);
	}

	w3++;

	w2=w3/3;

	if(document.getElementById("c4")){
		document.getElementById("c1").style.display="";
		document.getElementById("c2").style.display="";
		document.getElementById("c3").style.display="";
		document.getElementById("c4").style.display="";

		document.getElementById("c1").setAttribute('r',w2/1);
		document.getElementById("c2").setAttribute('r',w2/2);
		document.getElementById("c3").setAttribute('r',w2/4);
		document.getElementById("c4").setAttribute('r',w2/8);
	}

	if(w3==30){
		element=document.getElementById("clo");
		if(element){element.remove();}
	}

	document.getElementById("fish1").style.left=parseInt(document.getElementById("fish1").style.left)-1+"px";
	document.getElementById("fish2").style.left=parseInt(document.getElementById("fish2").style.left)+2+"px";
	document.getElementById("fish3").style.left=parseInt(document.getElementById("fish3").style.left)-2+"px";
	document.getElementById("fish4").style.left=parseInt(document.getElementById("fish4").style.left)+1+"px";

	if(w3>(window.innerWidth+100)){
		w3=0;
		document.getElementById("fish1").style.left=100+window.innerWidth+"px";
		document.getElementById("fish2").style.left="-100px";
		document.getElementById("fish3").style.left=100+window.innerWidth+"px";
		document.getElementById("fish4").style.left="-100px";
	}

	w4++;
	if(w4==30){ponta[50].material.color.set(0xffffff);}
	if(w4==60){ponta[50].material.color.set(0x000000);w4=0;}

}

parseInt(document.getElementById("fish1").style.left)-5

init();

animate();

/*

Hi Three.js followers,

Water worms doing stunts.


the link:

http://jrlazz.eu5.org/anim/waterworms.html

Again, Thanks for the great Three.js Team!

Jose Roberto Lazzareschi

P.S.: Somehow the wires have crossed... Communication's lost... (Lennon)

*/


document.getElementById("fish1").style.left=100+window.innerWidth+"px";
document.getElementById("fish2").style.left="-200px";
document.getElementById("fish3").style.left=100+window.innerWidth+"px";
document.getElementById("fish4").style.left="-200px";

</script>


<script>

var volu=0.5;

function valvol(volu){
	au.volume=volu;document.getElementById("alto").width=35*volu;
}

function dim(){
	document.getElementById("alto").width=document.getElementById("alto").width-1;
	if(document.getElementById("alto").width<0){document.getElementById("alto").width=0;}
	volu=volu-0.1;if(volu<0){volu=0;}
	valvol(volu);au.play();
}

function aum(){
	document.getElementById("alto").width=document.getElementById("alto").width+1;
	if(document.getElementById("alto").width>35){document.getElementById("alto").width=35;}
	volu=volu+0.1;if(volu>1){volu=1;}
	valvol(volu);au.play();
}

var limpa=1;
function ifralimp(){
limpa=1-limpa;
	if(limpa==0){
		document.getElementById("ifra").style.display="none";
		document.getElementById("tvr").style.display="";
		document.getElementById("tvg").style.display="none";
	}else{
		document.getElementById("ifra").style.display="";
		document.getElementById("tvg").style.display="";
		document.getElementById("tvr").style.display="none";
	}
}

document.getElementById("tabaud").style.left=window.innerWidth-160+"px";
document.getElementById("tabaud").style.top=window.innerHeight-160+"px";

valvol(volu);

</script>

</body>
</html>
