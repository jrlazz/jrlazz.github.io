<!DOCTYPE html>
<html lang="en">
<head>
<title>donut.html</title>
<meta charset="utf-8">
<link rel="shortcut icon" href="https://threejs.org/files/favicon.ico"/>

<style>
body{margin:0px;border:0px;background-color:#002244;font-family:Monospace;overflow:hidden;}
span{position:absolute;color:#ff0;font-size:9pt;cursor:pointer;}
</style>

</head>

<body>

<span id="spanA" style="left:100px;top:5px;">right click &rarr; inspect &rarr; source code</span>

<div id="container"></div>

<script type="module">

import * as THREE from '../js/three.module_res_res.js';
import Stats from '../js/stats.module_res_res.js';
import { OrbitControls } from '../js/OrbitControls_res_res.js';
import { ColladaLoader } from '../js/ColladaLoader_res_res.js';
import { GLTFLoader } from '../js/GLTFLoader_res_res.js';

var container, stats, clock, controls, loader;
var camera, scene, renderer, elf, objglb, objglb2;

init();
animate();

function init() {
	container=document.getElementById( 'container' );
	camera = new THREE.PerspectiveCamera(50,window.innerWidth/window.innerHeight,0.1,1000);
	camera.position.set(0,0,30);
	scene=new THREE.Scene();
	clock=new THREE.Clock();

	// loading manager
	const loadingManager=new THREE.LoadingManager(function(){scene.add(elf);});

	// Collada
	loader = new ColladaLoader(loadingManager);
	loader.load( 'models/extras/Donut_for_jose.dae',function (collada){
		elf=collada.scene;
		elf.scale.set(100,100,100);
		elf.position.set(-10,0,0);
	} );

	const ambientLight=new THREE.AmbientLight(0xffcc99,0.4);
	scene.add(ambientLight);

	const directionalLight=new THREE.DirectionalLight(0xffcc99,0.8);
	directionalLight.position.set(1,1,0 ).normalize();
	scene.add(directionalLight);

	renderer= new THREE.WebGLRenderer({antialias:true,alpha:true});
	renderer.setPixelRatio( window.devicePixelRatio );
	renderer.setSize( window.innerWidth, window.innerHeight );
	renderer.setClearColor(0x002244,1);
	container.appendChild( renderer.domElement );

	controls=new OrbitControls(camera,renderer.domElement);

	// GLTF
/*	loader=new GLTFLoader();
	loader.load('models/extras/Donut_for_jose.glb',function(gltf){
		objglb=gltf.scene;
		objglb.position.set(10,0,0);
		objglb.scale.set(100,100,100);
		scene.add(objglb);
	});
*/

	loader=new GLTFLoader();
	loader.load('models/extras/donut_an8.glb',function(gltf){
		objglb2=gltf.scene;
		objglb2.position.set(10,0,0);
		objglb2.scale.set(1,1,1);
		scene.add(objglb2);
	});


	stats=new Stats();
	container.appendChild(stats.dom);
	window.addEventListener('resize',onWindowResize);

}

function onWindowResize() {
	camera.aspect = window.innerWidth / window.innerHeight;
	camera.updateProjectionMatrix();
	renderer.setSize( window.innerWidth, window.innerHeight );
}

function animate(){
	requestAnimationFrame(animate);
	render();
	stats.update();
	controls.update();
}

function render(){
	const delta=clock.getDelta();
	if(elf !== undefined){elf.rotation.z += delta * 0.5;}
	//if(objglb){objglb.rotation.z -= delta;}
	if(objglb2){objglb2.rotation.z -= delta;objglb2.rotation.x -= delta;}
	renderer.render(scene,camera);
}

</script>
</body>
</html>
