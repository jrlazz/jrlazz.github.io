<!DOCTYPE html>
<html lang="en">
<head>
<title>planeclick3.html</title>
<meta charset="utf-8">
<link rel="icon" type="image/png" href="img/grad.png">
<meta name="description" content="Click on plane">
<meta name="twitter:image" content="img/ag_baboy_right.png" />
<meta name="twitter:image:type" content="png" />
<meta name="twitter:image:width" content="19" />
<meta name="twitter:image:height" content="47" />

<style>
body{margin:0px;border:0px;background-color:#024;font-family:Monospace;overflow:hidden;}
span{position:absolute;color:#ff0;font-size:14pt;}
</style>

<script type="importmap">
	{
		"imports": {
			"three": "https://cdn.jsdelivr.net/npm/three@0.174.0/build/three.module.min.js",
			"three/addons/": "https://cdn.jsdelivr.net/npm/three@0.174.0/examples/jsm/"
		}
	}
</script>

</head>

<body>

<span id="sp" style="left:10px;top:5px;">Where is the Sphere? ... click on plane ... </span>

<script type="module">

import * as THREE from 'three';
import { OrbitControls } from 'three/addons/controls/OrbitControls.js';

var camera, scene, renderer, controls,sphere;
var iw=window.innerWidth,ih=window.innerHeight;
var raycaster=new THREE.Raycaster(),selected,intersects=[],alvos=[];
var mouse=new THREE.Vector2();

	camera = new THREE.PerspectiveCamera(50,window.innerWidth/window.innerHeight,0.1,1000);
	camera.position.set(0,25,100);
	scene=new THREE.Scene();

	renderer= new THREE.WebGLRenderer({antialias:true,alpha:true});
	renderer.setPixelRatio( window.devicePixelRatio );
	renderer.setSize( window.innerWidth, window.innerHeight );
	renderer.setClearColor('#024',1);
	document.body.appendChild(renderer.domElement);

	window.addEventListener("mousedown",onClick);

	controls=new OrbitControls(camera,renderer.domElement);

	const mat=new THREE.MeshNormalMaterial({side:THREE.DoubleSide});
	const mesh=new THREE.Mesh(new THREE.PlaneGeometry(50,50),mat);
	mesh.rotation.set(1.57,0,0);
	mesh.name="mesh";
	alvos.push(mesh);
	scene.add(mesh);

	sphere=new THREE.Mesh(new THREE.SphereGeometry(10,32,32),mat);

	const luz=new THREE.AmbientLight("#fff",1);scene.add(luz);

function onClick(event){
	mouse.x=event.clientX/iw*2-1;
	mouse.y=-(event.clientY/ih)*2+1;
	raycaster.setFromCamera(mouse,camera);
	intersects=raycaster.intersectObjects(alvos,true);
	if(intersects.length>0){
		selected=intersects[0].object;
		if(selected.name=="mesh"){scene.add(sphere);};
		document.getElementById("sp").innerText="Here is the Sphere";
	}
}

function animate(){
	requestAnimationFrame(animate);
	controls.update();
	renderer.render(scene,camera);
}

animate();

</script>
</body>
</html>
