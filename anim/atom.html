<!DOCTYPE html>
<html lang="en">
<head>
<title>atom.html</title>
<meta charset="utf-8">
<link rel="shortcut icon" href="ok.ico"/>
<style>
@font-face {font-family:myq;src:url('../fonte/MysteryQuest-Regular.ttf');}
body{margin:0;background-color:#000;font-family:myq;color:#09c;overflow:hidden;}
span{position:absolute;left:0px;}
</style>

<script type="importmap">
	{
	  "imports": {
		"three": "https://unpkg.com/three@0.173.0/build/three.module.min.js",
		"three/addons/": "https://unpkg.com/three@0.173.0/examples/jsm/"
	  }
	}
</script>

</head>

<body>

<span id="sp2" style="top:10px;color:#069;font-size:16pt;width:99%;text-align:center;">... a dream vision of an atom ...</span>

<script type="module">
import * as THREE from "three";

var scene,camera,camera2,renderer,controls,wand1,wand2, kcode;
var position;
var vector=new THREE.Vector3();

var avec=[];
for(let z=0;z<1000;z++){avec[z]=new THREE.Vector3();}

var g=[],m=[],s=[],e=[];

var lig;
var num=0;
var t=0;
var p=Math.PI;
var letters,color;

function init(){

	scene=new THREE.Scene();

	camera=new THREE.PerspectiveCamera(50,window.innerWidth/window.innerHeight,0.1,1000);
	scene.add(camera);
	camera.position.set(0,0,20);
	
	renderer=new THREE.WebGLRenderer({antialias:true,alpha:true});
	renderer.setClearColor(0x000000,0);
	renderer.setSize(window.innerWidth, window.innerHeight);	

	document.body.appendChild(renderer.domElement); 

	window.addEventListener("resize",onWindowResize);

	g[11]=new THREE.RingGeometry(2.5,2.7,64,64,1,p);
	m[11]=new THREE.MeshStandardMaterial({color:'#f66',side:THREE.DoubleSide,metalness:0.8,roughness:0.3});
	e[11]=new THREE.Mesh(g[11],m[11]); 
	e[11].rotation.set(0,-p/2,0); 
	scene.add(e[11]);

	g[12]=new THREE.RingGeometry(3,3.2,64,64,2,p);
	m[12]=new THREE.MeshStandardMaterial({color:'#ff6',side:THREE.DoubleSide,metalness:0.8,roughness:0.3});
	e[12]=new THREE.Mesh(g[12],m[12]);
	e[12].rotation.set(0,p/1.5,0);
	scene.add(e[12]);

	g[13]=new THREE.RingGeometry(3.5,3.7,64,64,0,p);
	m[13]=new THREE.MeshStandardMaterial({color:'#f6f',side:THREE.DoubleSide,metalness:0.8,roughness:0.3});
	e[13]=new THREE.Mesh(g[13],m[13]);
	e[13].rotation.set(0,p/2,0);
	scene.add(e[13]);

	g[14]=new THREE.RingGeometry(4,4.2,64,64,p/2,p);
	m[14]=new THREE.MeshStandardMaterial({color:'#ff9',side:THREE.DoubleSide,metalness:0.8,roughness:0.3});
	e[14]=new THREE.Mesh(g[14],m[14]);
	e[14].rotation.set(0,p/2.5,0);
	scene.add(e[14]);

	g[15]=new THREE.RingGeometry(4.5,4.7,64,64,p/5,p);
	m[15]=new THREE.MeshStandardMaterial({color:'#99f',side:THREE.DoubleSide,metalness:0.8,roughness:0.3});
	e[15]=new THREE.Mesh(g[15],m[15]);
	e[15].rotation.set(0,p/3,0);
	scene.add(e[15]);

	g[16]=new THREE.RingGeometry(5,5.2,64,64,p/3,p/1.5);
	m[16]=new THREE.MeshStandardMaterial({color:'#f6f',side:THREE.DoubleSide,metalness:0.8,roughness:0.3});
	e[16]=new THREE.Mesh(g[16],m[16]);
	e[16].rotation.set(0,p,0);
	scene.add(e[16]);

	g[17]=new THREE.RingGeometry(5.5,5.7,64,64,0,p/3);
	m[17]=new THREE.MeshStandardMaterial({color:'#6f6',side:THREE.DoubleSide,metalness:0.8,roughness:0.3});
	e[17]=new THREE.Mesh(g[17],m[17]);
	e[17].rotation.set(0,p/2,0);
	scene.add(e[17]);

	g[18]=new THREE.RingGeometry(6,6.2,64,64,0,p);
	m[18]=new THREE.MeshStandardMaterial({color:'#fff',side:THREE.DoubleSide,metalness:0.8,roughness:0.3});
	e[18]=new THREE.Mesh(g[18],m[18]);
	e[18].rotation.set(0,p/4.5,0);
	scene.add(e[18]);

	g[1]=new THREE.SphereGeometry(32,42,42);
	m[1]=new THREE.MeshStandardMaterial({color:'#ccc',transparent:true,opacity:0.5});
	s[1]=new THREE.Mesh(g[1],m[1]);
	s[1].position.set(0,0,0);
	scene.add(s[1]);         

 	console.log(s[1].geometry.isBufferGeometry);
	console.log(s[1].isMesh);
	if(s[1].isMesh){
		position=s[1].geometry.attributes.position;
		vector=new THREE.Vector3();
		for(let i=0;i<position.count;i++){
			if(i){
				//document.getElementById("sp2").innerText=i+" v\xe9rtices";
 				vector.fromBufferAttribute(position,i);
				vector.applyMatrix4(s[1].matrixWorld);
				avec[i]=vector.clone();
			}
		}
	}

	g[2]=new THREE.SphereGeometry(2,128,128);
	m[2]=new THREE.MeshStandardMaterial({color:'#fff',metalness:0.9,roughness:0.1,transparent:true,opacity:0.99});
	s[2]=new THREE.Mesh(g[2],m[2]);
	s[2].position.set(0,0,0);
	s[2].name="Atenciosamente";
	scene.add(s[2]); 

	lig=new THREE.SpotLight( 0xffffff,5000,200,0.04,1,1 );
	lig.position.set(0,20,-10);scene.add(lig);

	//lig=new THREE.PointLight(0xffffff,4000);
	//lig.position.set(0,20,-10);scene.add(lig);

	//var lig2=new THREE.AmbientLight('#fff',3);scene.add(lig2);

}

function onWindowResize(){
	camera.aspect=window.innerWidth/window.innerHeight;
	camera.updateProjectionMatrix();
	renderer.setSize(window.innerWidth,window.innerHeight);
}

function animate(){
	requestAnimationFrame( animate );
	num=parseInt(Math.random()*1087);
	t++;
	if(t<2){
		if(avec[num]){lig.color.set(getRandomColor());lig.position.set(avec[num].x,avec[num].y,avec[num].z);}
	}
	if(avec[num]){lig.color.set(getRandomColor());lig.position.set(avec[num].x*Math.random()*10,avec[num].y*Math.random()*10,avec[num].z*Math.random()*10);}
	if(t>120){t=0;}

	if(e[14]){
		e[11].rotation.x +=0.04;
		e[12].rotation.x +=0.06;
		e[13].rotation.x +=0.03;
		e[14].rotation.x +=0.01;
		e[15].rotation.x +=0.03;
		e[16].rotation.x +=0.01;
		e[17].rotation.x +=0.05;
		e[18].rotation.x +=0.07;
	}

	function getRandomColor(){
  		letters='0123456789ABCDEF';
  		color='#';
  		for(let i=0;i<6;i++){color +=letters[Math.floor(Math.random()*16)];
 		}
  		return color;
	}
	renderer.render(scene,camera);	
}

init();
animate();

</script>
</body>
</html>
