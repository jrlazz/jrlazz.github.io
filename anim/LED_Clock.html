<!DOCTYPE html>
<html lang="en">
<head>
<title>LED_Clock.html</title>
<meta charset="utf-8">
<link rel="shortcut icon" href="https://threejs.org/files/favicon.ico"/>
<style>
audio {filter: invert(120%) sepia(0%) saturate(7000%) hue-rotate(60deg) brightness(100%) contrast(80%); border-radius:5px; opacity:1;padding:0px;border:1px solid #ccc;}
button{border:1px solid #ccc;border-radius:5px;font-size:12pt;font-weight:bold;background-color:#000;color:#0ff;padding:0px;}
input{border:1px solid #ccc;}
</style>
</head>

<body style="font-family:Monospace;font-size:14pt;overflow:hidden;margin:0px;background-color:#045;">


<span id="spanA" style="position:absolute;left:10px;top:5px;color:#ff0;font-size:9pt;">right click &rarr; inspect &rarr; source code</span>
<span id="spanB" style="position:absolute;left:-10px;top:5px;color:#ff0;font-size:9pt;">0</span>
<table id="menu" style="position:absolute;left:10px;top:25px;display:none;">
<tr>
<td colspan="5" style="text-align:center;color:#fff;font-size:14pt;">A L A R M</td>
</tr><tr>
<td style="color:#f6f;">Today</td>
<td style="color:#f6f;text-align:right;">Day</td><td><input style="width:26px;font-size:12pt;font-weight:bold;background-color:#000;color:#0ff;text-align:center;" id="dia" autocomplete="off" type="text" readonly value=></input></td>
<td style="color:#f6f;text-align:right;">Month</td><td><input style="width:26px;font-size:12pt;font-weight:bold;background-color:#000;color:#0ff;text-align:center;" id="mes" autocomplete="off" type="text" readonly value=></input></td>
</tr><tr>
<td style="color:#ff0;">Alarm</td>
<td style="color:#0ff;text-align:right;">Day</td><td><input style="width:48px;font-size:12pt;font-weight:bold;background-color:#000;color:#0ff;text-align:center;" id="diaA" autocomplete="off" onclick="podesom();" type="number" min=1 max=31 value=31></input></td>
<td style="color:#0ff;text-align:right;">Month</td><td><input style="width:48px;font-size:12pt;font-weight:bold;background-color:#000;color:#0ff;text-align:center;" id="mesA" autocomplete="off" onclick="podesom();" type="number" min=1 max=12 value=12></input><button style="width:24px;" onclick="igualaDM();">=</button></td>
</tr><tr>
<td style="color:#ff0;">Alarm</td>
<td style="color:#0ff;text-align:right;">Hour</td><td><input style="width:48px;font-size:12pt;font-weight:bold;background-color:#000;color:#0ff;text-align:center;" id="hor" autocomplete="off" onclick="podesom();" type="number" min=0 max=24 value=24></input></td>
<td style="color:#0ff;text-align:right;">Min.</td><td><input style="width:48px;font-size:12pt;font-weight:bold;background-color:#000;color:#0ff;text-align:center;" id="min" autocomplete="off" onclick="podesom();" type="number" min=0 max=59 value=59></input></td>
</tr><tr>
<td style="color:#ff0;">Alarm</td><td colspan="4" style="text-align:center;"><button id="reset" style="width:160px;" onclick="reseta();">RESET</button></td>
</tr><tr>
<td></td><td colspan="4" style="vertical-align:bottom;text-align:center;"><audio id="au" controls loop style="width:160px;height:23px;display:;vertical-align:bottom;"><source src="unstress_you_red.mp3" type="audio/mpeg"></audio></td>
</tr>
</table>

<svg id="clo" viewBox="0 0 50 50" style="position:absolute;left:100px;top:50px;width:20%;z-index:2;display:;">
<circle style="stroke:#0ff;stroke-width:0.5px;fill:#0240" cx="10" cy="10" r="8"></circle>
<line x1="10" y1="10" x2="10" y2="3" style="stroke-width:0.5px;stroke:#0ff;">
<animateTransform attributeType="xml" attributeName="transform" type="rotate" from="0,10,10" to="360,10,10" dur="5s" repeatCount="indefinite" />
</line>
</svg>


<script type="module">

import * as THREE from '../js/three.module_res_res.js';
import { FontLoader} from '../js/FontLoader_res_res.js';
import { TextGeometry } from '../js/TextGeometry_res_res.js';
import { OrbitControls } from '../js/OrbitControls_res_res.js';
import { DDSLoader } from '../js/DDSLoader_res_res.js';
import { MTLLoader } from '../js/MTLLoader_res_res.js';
import { OBJLoader } from '../js/OBJLoader_res_res.js';

var diaR=document.getElementById("dia");
var mesR=document.getElementById("mes");

var diaAR=document.getElementById("diaA");
var mesAR=document.getElementById("mesA");

diaR.value=Number(new Date().getDate());
mesR.value=Number(new Date().getMonth())+1;

var spanBR=document.getElementById("spanB");

var b=[];
var bm=[];
var woo=[];
var w=0;
var y=0;
var z=0;

var hS="";
var mS="";
var hm="";

var dp=1;

var horval=0;
var minval=0;
var horvalstr="";
var minvalstr="";
var simsom=0;
var Glin1=new THREE.Group();
var Glin2=new THREE.Group();
var Glin3=new THREE.Group();

var element;

var container,camera,scene,ambient,renderer,controls,manager,loader,Mesh,Geo,Mat;
var text="01:38:89 ... Time",bevelEnabled=false,font=undefined;
var wW=window.innerWidth,wH=window.innerHeight;
var height=1,size=37,hover=30,curveS=1,bevT=0,bevS=0;

	container=document.createElement('div');
	document.body.appendChild(container);

	camera=new THREE.PerspectiveCamera(90,wW/wH,1,1500);
	camera.position.set(0,0,60);

	scene=new THREE.Scene();

	renderer=new THREE.WebGLRenderer({antialias:true});
	renderer.setPixelRatio(window.devicePixelRatio);
	renderer.setSize(wW,wH);
	renderer.setClearColor('#045',1);


	container.appendChild(renderer.domElement);

	controls=new OrbitControls(camera,renderer.domElement);
	controls.minDistance=20;
	controls.maxDistance=200;
	controls.enablePan=true;
	controls.enableZoom=true;
	controls.enableRotate=true;
	controls.enableDamping=true;

	window.addEventListener('resize',onResize,false);

	manager=new THREE.LoadingManager();
	manager.onStart=function(url,itemsLoaded,itemsTotal){console.log('Started loading file:'+url+'.\nLoaded '+itemsLoaded+' of '+itemsTotal + ' files.' );};
	manager.onLoad=function(){console.log('Loading complete!');};
	manager.onProgress=function(url,itemsLoaded,itemsTotal){console.log('loading texture'+url+' '+(itemsLoaded/itemsTotal*100)+'%');};
	manager.onError=function(url){console.log('Error loading texture:'+url);};
	manager.addHandler(/\.dds$/i,new DDSLoader());

	ambient=new THREE.AmbientLight("#fff",1);
	scene.add(ambient);

	var frontLight=new THREE.DirectionalLight('#fc9',1);
	frontLight.position.set(0,10,40);
	scene.add(frontLight);

	var pointLight=new THREE.PointLight('#fc9',1);
	pointLight.position.set(0,10,40 );
	scene.add(pointLight);

loader=new FontLoader();
loader.load('fonte/5x7.json',function(response){font=response;});
Mat=new THREE.MeshStandardMaterial({color:'#0ff'});

function createText(text){
	scene.remove(Mesh);
	Geo=new TextGeometry(text,{
	font:font,size:37,height:1,curveSegments:0,bevelThickness:0,bevelSize:0,bevelEnabled:false});
	Mesh=new THREE.Mesh(Geo,Mat);
	Mesh.position.set(-32,0,.5);
	Mesh.scale.set(0.4,0.4,0.4);
	scene.add(Mesh);
}
	var bL=new THREE.TextureLoader(manager);
	var bM=[
	new THREE.MeshBasicMaterial({map:bL.load('img/gray.png')}),
	new THREE.MeshBasicMaterial({map:bL.load('img/gray.png')}),
	new THREE.MeshBasicMaterial({map:bL.load('img/gray.png')}),
	new THREE.MeshBasicMaterial({map:bL.load('img/gray.png')}),
	new THREE.MeshBasicMaterial({map:bL.load('img/black.png')}),
	new THREE.MeshBasicMaterial({map:bL.load('img/gray.png')}),
	];

	var base=106.1;
	base=116.1;
	var mult=2.462;
	var fun=-0.15;
	base=35.6;

	var bG=new THREE.BoxGeometry(2,2,2);
	for(z=1;z<29;z++){
		b[z]=new THREE.Mesh(bG,bM);
		b[z].position.set(base-(z*mult),1,fun);		scene.add(b[z]);
		b[z+100]=new THREE.Mesh(bG,bM);
		b[z+100].position.set(base-(z*mult),3.5,fun);	scene.add(b[z+100]);
		b[z+200]=new THREE.Mesh(bG,bM);
		b[z+200].position.set(base-(z*mult),6,fun);	scene.add(b[z+200]);
		b[z+300]=new THREE.Mesh(bG,bM);
		b[z+300].position.set(base-(z*mult),8.5,fun);	scene.add(b[z+300]);
		b[z+400]=new THREE.Mesh(bG,bM);
		b[z+400].position.set(base-(z*mult),11,fun);	scene.add(b[z+400]);
		b[z+500]=new THREE.Mesh(bG,bM);
		b[z+500].position.set(base-(z*mult),13.5,fun);	scene.add(b[z+500]);
		b[z+600]=new THREE.Mesh(bG,bM);
		b[z+600].position.set(base-(z*mult),16,fun);	scene.add(b[z+600]);
		b[z+700]=new THREE.Mesh(bG,bM);
		b[z+700].position.set(base-(z*mult),18.5,fun);	scene.add(b[z+700]);
		b[z+800]=new THREE.Mesh(bG,bM);
		b[z+800].position.set(base-(z*mult),-1.5,fun);	scene.add(b[z+800]);
	}

	var bQ=new THREE.BoxGeometry(80,40,2);
	var matcup=new THREE.MeshPhysicalMaterial({color:0xffffff,transparent:true,opacity:0.1});
	var bQQ=new THREE.Mesh(bQ,matcup);
	bQQ.position.set(0,8.4,0);

	var matlin1=new THREE.LineBasicMaterial({color:'#f00'});
	var points=[];
	points.push(new THREE.Vector3(0,0,0));
	points.push(new THREE.Vector3(0,10,0));
	var lingeo1=new THREE.BufferGeometry().setFromPoints(points);
	var lin1=new THREE.Line(lingeo1,matlin1);
	lin1.position.set(11.85,-12,-0.5);
		var matlin2=new THREE.LineBasicMaterial({color:'#0c0'});
		var lin2=new THREE.Line(lingeo1,matlin2);
		lin2.position.set(12.6,-12,-0.5);
	var matlin3=new THREE.LineBasicMaterial({color:'#00f'});
	var lin3=new THREE.Line(lingeo1,matlin4);
	lin3.position.set(13.3,-12,-0.5);
		var matlin4=new THREE.LineBasicMaterial({color:'#f0f'});
		var lin4=new THREE.Line(lingeo1,matlin4);
		lin4.position.set(14.1,-12,-0.5);
	Glin1.add(lin1);Glin1.add(lin2);Glin1.add(lin3);Glin1.add(lin4);
	Glin1.position.set(0,0,0);
	Glin2=Glin1.clone();
	Glin2.rotation.set(1.57,0,1.57);
	Glin2.scale.set(1,10,1);
	Glin2.position.set(20,-11,0);
	Glin3=Glin2.clone();
	Glin3.position.set(20,-11,-3);

		var wmtl2="models/extras/tr_to_220_B.mtl";
		var wobj2="models/extras/tr_to_220_B.obj";
		new MTLLoader(manager).load(wmtl2,function(mat){mat.preload(manager);new OBJLoader(manager).setMaterials(mat).load(wobj2,function(object){woo[2]=object;},manager.onProgress,manager.onError);});

		var wmtl3="models/extras/diode_B.mtl";
		var wobj3="models/extras/diode_B.obj";
		new MTLLoader(manager).load(wmtl3,function(mat){mat.preload(manager);new OBJLoader(manager).setMaterials(mat).load(wobj3,function(object){woo[3]=object;},manager.onProgress,manager.onError);});

		var wmtl4="models/extras/resistor_B.mtl";
		var wobj4="models/extras/resistor_B.obj";
		new MTLLoader(manager).load(wmtl4,function(mat){mat.preload(manager);new OBJLoader(manager).setMaterials(mat).load(wobj4,function(object){woo[4]=object;},manager.onProgress,manager.onError);});

		var wmtl5="models/extras/cint.mtl";
		var wobj5="models/extras/cint.obj";
		new MTLLoader(manager).load(wmtl5,function(mat){mat.preload(manager);new OBJLoader(manager).setMaterials(mat).load(wobj5,function(object){woo[5]=object;},manager.onProgress,manager.onError);});

	var bplT=new THREE.TextureLoader().load('img/pcb03a.png');
	var bplG=new THREE.BoxGeometry(80,40,1);
	var bplMat=new THREE.MeshStandardMaterial({color:'#333',map:bplT});
	var bplM=new THREE.Mesh(bplG,bplMat);
	bplM.position.set(0,-12,0);
	bplM.rotation.set(1.47,0,0);

	var bplMatb=new THREE.MeshStandardMaterial({color:'#000'});
	var bplMb=new THREE.Mesh(bplG,bplMatb);
	bplMb.position.set(0,-12.1,0);
	bplMb.rotation.set(1.47,0,0);

	var byG=new THREE.BoxGeometry(4,6,1);

	var byMat1=new THREE.MeshStandardMaterial({color:'#082040'});
	bm[1]=new THREE.Mesh(byG,byMat1);
	bm[1].scale.set(1.2,1.2,1);
	bm[1].rotation.set(1.47,0,0);
	bm[1].position.set(-22,-10,13);
		var byMat2=new THREE.MeshStandardMaterial({color:'#400'});
		bm[2]=new THREE.Mesh(byG,byMat2);
		bm[2].scale.set(1.2,1.2,1);
		bm[2].scale.set(0.6,1,1);
		bm[2].rotation.set(1.47,0,0);
		bm[2].position.set(-38,-10,15.5);
	var byMat3=new THREE.MeshStandardMaterial({color:'#131'});
	bm[3]=new THREE.Mesh(byG,byMat3);
	bm[3].scale.set(0.7,1,1);
	bm[3].rotation.set(1.47,0,0);
	bm[3].position.set(5.4,-10,12);
		var byMat4=new THREE.MeshStandardMaterial({color:'#441'});
		bm[4]=new THREE.Mesh(byG,byMat4);
		bm[4].scale.set(1.4,0.8,1);
		bm[4].rotation.set(1.47,0,0);
		bm[4].position.set(-4,-10,12);
	bm[5]=bm[4].clone();
	bm[5].scale.set(1.6,1,1);
	bm[5].position.set(-36.2,-10,9.5);
		bm[6]=bm[3].clone();
		bm[6].scale.set(1.4,0.8,1);
		bm[6].position.set(-33.6,-10,16);
	bm[7]=bm[4].clone();
	bm[7].scale.set(1,1.6,1);
	bm[7].position.set(33.5,-10,13.7);
		bm[8]=bm[1].clone();
		bm[8].scale.set(0.2,1,5);
		bm[8].position.set(17,-8,16);
	var byMat9=new THREE.MeshStandardMaterial({color:'#313'});
	bm[9]=new THREE.Mesh(byG,byMat9);
	bm[9].scale.set(0.4,1,6.5);
	bm[9].position.set(32.5,-9,-5);
		bm[10]=bm[2].clone();
		bm[10].scale.set(1.5,2,1);
		bm[10].position.set(21.3,-9.5,14);

function onResize() {
	camera.aspect=window.innerWidth/window.innerHeight;
	camera.updateProjectionMatrix();
	renderer.setSize(window.innerWidth,window.innerHeight);
}

function animate(){
	requestAnimationFrame(animate);
	controls.update();
	render();
}

function render(){
	renderer.render(scene,camera);
	y++;
	w++;
	if(w==60){
		hS=new Date().getHours();if(Number(hS)<10){hS="0"+hS;}
		mS=new Date().getMinutes();if(Number(mS)<10){mS="0"+mS;}
		hm=hS+" "+mS;
		if(dp==1){hm=hS+":"+mS;}
		createText(hm);
		dp=1-dp;
		w=0;
		horval=Number(document.getElementById("hor").value);horvalstr=horval.toString();if(horval<10){horvalstr="0"+horval;}
		minval=Number(document.getElementById("min").value);minvalstr=minval.toString();if(minval<10){minvalstr="0"+minval;}
		if(Number(horvalstr+minvalstr<=Number(hm.substring(0,2)+hm.substring(3)))){
			if(spanBR.innerText=="1" && diaAR.value==diaR.value && mesAR.value==mesR.value){au.play();}
		}
		if(Number(horvalstr+minvalstr>Number(hm.substring(0,2)+hm.substring(3)))){if(spanBR.innerText=="1"){au.pause();}}
	}
	if(y==120){
		scene.add(bplM);scene.add(bplMb);
		for(z=1;z<11;z++){scene.add(bm[z]);}
		woo[2].position.set(-10.75,-10.6,2.75);
		scene.add(woo[2]);
			woo[21]=woo[2].clone();
			woo[21].position.set(-4.74,-10.6,-7.3);
			scene.add(woo[21]);
		woo[3].scale.set(0.9,0.9,0.9);
		woo[3].position.set(0.4,-12.2,-11.3);
		scene.add(woo[3]);
			woo[31]=woo[3].clone();
			woo[31].position.set(0.4,-12.2,-9.6);
			scene.add(woo[31]);
		woo[4].scale.set(0.9,0.9,0.9);
		woo[4].position.set(16,-12.2,-10.31);
		scene.add(woo[4]);
			woo[41]=woo[4].clone();
			woo[41].position.set(-24.2,-12.2,-12.3);
			scene.add(woo[41]);
			woo[42]=woo[4].clone();
			woo[42].position.set(-27.2,-11.5,-4.7);
			scene.add(woo[42]);
			woo[43]=woo[4].clone();
			woo[43].scale.set(1.1,0.9,0.9);
			woo[43].position.set(-7.8,-12.5,-16.9);
			scene.add(woo[43]);
			woo[44]=woo[43].clone();
			woo[44].position.set(-7.8,-12.5,-13.3);
			scene.add(woo[44]);
			woo[45]=woo[4].clone();
			woo[45].position.set(13,-10.4,6);
			scene.add(woo[45]);
			woo[46]=woo[45].clone();
			woo[46].position.set(17.2,-10.5,4.5);
			scene.add(woo[46]);
		woo[5].scale.set(0.3,0.3,0.3);
		woo[5].position.set(-28,-10,12);
		scene.add(woo[5]);
			woo[51]=woo[5].clone();
			woo[51].position.set(5,-12.5,-15.5);
			scene.add(woo[51]);
			woo[52]=woo[5].clone();
			woo[52].position.set(34,-12.5,-14);
			scene.add(woo[52]);
			woo[53]=woo[5].clone();
			woo[53].rotation.set(0,1.57,0);
			woo[53].position.set(38,-9.5,15.5);
			scene.add(woo[53]);
			woo[54]=woo[53].clone();
			woo[54].position.set(38,-9.5,6);
			scene.add(woo[54]);
		scene.add(Glin1);
		scene.add(Glin2);
		scene.add(Glin3);
		scene.add(bQQ);
		element=document.getElementById("clo");
		if(element){element.remove();}
		document.getElementById("menu").style.display="";
	}
}

animate();

/*

Hi Three.js followers,

3Digital clock FontLoader-ed

My 3Digital clock, with alarm.

My song, unstressYou, was composed in 2000 after an heart attack... to unstress me!

And I hope it unstresses You!

the link:

http://jrlazz.eu5.org/anim/LED_Clock.html

Again, Thanks for the great Three.js Team!

Jose Roberto Lazzareschi

*/

</script>

<script>
function podesom(){
	document.getElementById("spanB").innerText="1";
}
function reseta(){
	document.getElementById("diaA").value=31;document.getElementById("mesA").value=12;
	document.getElementById("hor").value=24;document.getElementById("min").value=59;
	document.getElementById("spanB").innerText="0";
	au.pause();
}
function igualaDM(){
	document.getElementById("diaA").value=document.getElementById("dia").value;
	document.getElementById("mesA").value=document.getElementById("mes").value;
	au.pause();
}
</script>
</body>
</html>
