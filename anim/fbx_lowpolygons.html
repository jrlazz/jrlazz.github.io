<!DOCTYPE html>
<html lang="en">
<head>
<title>fbx_lowpolygons.html</title>
<meta charset="utf-8">
<link rel="shortcut icon" href="https://threejs.org/files/favicon.ico"/>

<style>
body{margin:0px;border:0px;background-color:#002244;font-family:Monospace;overflow:hidden;}
span{position:absolute;color:#ff0;font-size:9pt;cursor:pointer;}
</style>

</head>

<body>

<span id="spanA" style="left:100px;top:5px;">right click &rarr; inspect &rarr; source code</span>

<script type="module">
import * as THREE from '../js/three.module_res_res.js';
import Stats from '../js/stats.module_res_res.js';
import { OrbitControls } from '../js/OrbitControls_res_res.js';
import { FBXLoader } from '../js/FBXLoader_res_res.js';

var camera, scene, renderer, loader, controls, stats, mesh, poly, ambLight, dirLight, tex;

function init(){

	camera=new THREE.PerspectiveCamera(60,window.innerWidth/window.innerHeight,1,1000);
	camera.position.set(0,25,50);

	scene=new THREE.Scene();
	scene.background=new THREE.Color(0x112244);

	ambLight=new THREE.AmbientLight(0xffcc99,0.7);
	scene.add(ambLight);
	dirLight=new THREE.DirectionalLight(0xffffff,0.7);
	dirLight.position.set(-120, 200, 10);
	dirLight.castShadow=true;
	dirLight.shadow.camera.top=180;
	dirLight.shadow.camera.bottom=- 100;
	dirLight.shadow.camera.left=- 120;
	dirLight.shadow.camera.right=120;
	scene.add(dirLight);

	// ground
	tex=new THREE.TextureLoader().load('models/extras/blender_cor_03.jpg');
	tex.wrapS=THREE.RepeatWrapping;tex.wrapT=THREE.RepeatWrapping;
	tex.repeat.set(3,3);
	mesh=new THREE.Mesh(new THREE.PlaneGeometry(50,50), new THREE.MeshPhongMaterial({ map:tex,color: 0xcccccc,side:THREE.DoubleSide, depthWrite: true }));
	mesh.rotation.x=- Math.PI / 2;
	mesh.receiveShadow=true;
	scene.add(mesh);


	// lowpoligons.blend
	loader=new FBXLoader();
	loader.load('models/extras/lowpoligons.fbx',function(object){
		//mixer=new THREE.AnimationMixer(object);
		object.traverse(function(child){
			if (child.isMesh){child.castShadow=true;child.receiveShadow=true;}
		});
		poly=object;
		poly.position.set(0,8,0);
		poly.scale.set(0.01,0.01,0.01);
		scene.add(poly);
	});

	renderer=new THREE.WebGLRenderer({antialias: true});
	renderer.setPixelRatio(window.devicePixelRatio);
	renderer.setSize(window.innerWidth,window.innerHeight);
	renderer.shadowMap.enabled=true;
	document.body.appendChild(renderer.domElement);

	controls=new OrbitControls(camera,renderer.domElement);
	controls.update();

	window.addEventListener('resize',onWindowResize);

	// stats
	stats=new Stats();
	document.body.appendChild(stats.dom);
}

function onWindowResize(){
	camera.aspect=window.innerWidth/window.innerHeight;
	camera.updateProjectionMatrix();
	renderer.setSize(window.innerWidth,window.innerHeight);
}

function animate() {
	requestAnimationFrame(animate);
	renderer.render(scene,camera);
	stats.update();
	if(poly){poly.rotation.y +=0.01;}
}

init();

animate();

</script>

</body>
</html>
